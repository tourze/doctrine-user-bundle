# Doctrine User Bundle æµ‹è¯•è®¡åˆ’

## æµ‹è¯•æ¦‚è§ˆ

- **æ¨¡å—åç§°**: Doctrine User Bundle
- **æµ‹è¯•ç±»åž‹**: é›†æˆæµ‹è¯• + å•å…ƒæµ‹è¯•
- **æµ‹è¯•æ¡†æž¶**: PHPUnit 10.0+
- **ç›®æ ‡**: å®Œæ•´åŠŸèƒ½æµ‹è¯•è¦†ç›–ï¼ŒéªŒè¯è‡ªåŠ¨è®°å½•ç”¨æˆ·ä¿¡æ¯åŠŸèƒ½

## Attribute å•å…ƒæµ‹è¯•ç”¨ä¾‹è¡¨

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•ç±» | å…³æ³¨é—®é¢˜å’Œåœºæ™¯ | å®Œæˆæƒ…å†µ | æµ‹è¯•é€šè¿‡ |
|---|-----|---|----|---|
| tests/Attribute/AttributeTest.php | AttributeTest | å±žæ€§å®žä¾‹åŒ–ã€åå°„èŽ·å–ã€ç›®æ ‡éªŒè¯ | âœ… å·²å®Œæˆ | âœ… æµ‹è¯•é€šè¿‡ |

## DependencyInjection å•å…ƒæµ‹è¯•ç”¨ä¾‹è¡¨

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•ç±» | å…³æ³¨é—®é¢˜å’Œåœºæ™¯ | å®Œæˆæƒ…å†µ | æµ‹è¯•é€šè¿‡ |
|---|-----|---|----|---|
| tests/DependencyInjection/DoctrineUserExtensionTest.php | DoctrineUserExtensionTest | æ‰©å±•å®žä¾‹åŒ–ã€æœåŠ¡æ³¨å†Œã€è‡ªåŠ¨è£…é… | âœ… å·²å®Œæˆ | âœ… æµ‹è¯•é€šè¿‡ |

## Bundle å•å…ƒæµ‹è¯•ç”¨ä¾‹è¡¨

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•ç±» | å…³æ³¨é—®é¢˜å’Œåœºæ™¯ | å®Œæˆæƒ…å†µ | æµ‹è¯•é€šè¿‡ |
|---|-----|---|----|---|
| tests/DoctrineUserBundleTest.php | DoctrineUserBundleTest | Bundle å®žä¾‹åŒ–ã€ä¾èµ–å…³ç³»éªŒè¯ | âœ… å·²å®Œæˆ | âœ… æµ‹è¯•é€šè¿‡ |

## EventSubscriber æµ‹è¯•ç”¨ä¾‹è¡¨

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•ç±» | æµ‹è¯•ç±»åž‹ | å…³æ³¨é—®é¢˜å’Œåœºæ™¯ | å®Œæˆæƒ…å†µ | æµ‹è¯•é€šè¿‡ |
|---|-----|---|---|----|---|
| tests/EventSubscriber/UserListenerTest.php | UserListenerTest | å•å…ƒæµ‹è¯• | ç”¨æˆ·èŽ·å–é€»è¾‘ã€å®‰å…¨ä¸Šä¸‹æ–‡å¤„ç†ã€ç©ºç”¨æˆ·åœºæ™¯ | âœ… å·²å®Œæˆ | âœ… æµ‹è¯•é€šè¿‡ |
| tests/EventSubscriber/UserListenerIntegrationTest.php | UserListenerIntegrationTest | é›†æˆæµ‹è¯• | å®¹å™¨æœåŠ¡èŽ·å–ã€Doctrineäº‹ä»¶å¤„ç†ã€æŽ¥å£å®žçŽ° | âœ… å·²å®Œæˆ | âœ… æµ‹è¯•é€šè¿‡ |

## Traits å•å…ƒæµ‹è¯•ç”¨ä¾‹è¡¨

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•ç±» | å…³æ³¨é—®é¢˜å’Œåœºæ™¯ | å®Œæˆæƒ…å†µ | æµ‹è¯•é€šè¿‡ |
|---|-----|---|----|---|
| tests/Traits/BlameableAwareTest.php | BlameableAwareTest | Trait å±žæ€§è®¾ç½®ã€èŽ·å–ã€é“¾å¼è°ƒç”¨ã€é»˜è®¤å€¼ | âœ… å·²å®Œæˆ | âœ… æµ‹è¯•é€šè¿‡ |

## Integration æµ‹è¯•ç”¨ä¾‹è¡¨

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•ç±» | å…³æ³¨é—®é¢˜å’Œåœºæ™¯ | å®Œæˆæƒ…å†µ | æµ‹è¯•é€šè¿‡ |
|---|-----|---|----|---|
| tests/Integration/DoctrineUserIntegrationTest.php | DoctrineUserIntegrationTest | Bundle å’Œ UserListener åŸºç¡€é›†æˆ | âœ… å·²å®Œæˆ | âœ… æµ‹è¯•é€šè¿‡ |

## æµ‹è¯•ç”¨ä¾‹è¯¦ç»†è¯´æ˜Ž

### 1. Attribute æµ‹è¯•

- **CreateUserColumn**: å±žæ€§å®žä¾‹åŒ–å’Œåå°„æ£€æµ‹
- **CreatedByColumn**: å±žæ€§å®žä¾‹åŒ–å’Œåå°„æ£€æµ‹
- **UpdateUserColumn**: å±žæ€§å®žä¾‹åŒ–å’Œåå°„æ£€æµ‹
- **UpdatedByColumn**: å±žæ€§å®žä¾‹åŒ–å’Œåå°„æ£€æµ‹

### 2. DependencyInjection æµ‹è¯•

- **æ‰©å±•åŠ è½½**: éªŒè¯æœåŠ¡å®šä¹‰æ³¨å†Œ
- **è‡ªåŠ¨è£…é…**: éªŒè¯æœåŠ¡é…ç½®æ­£ç¡®
- **å±žæ€§è®¿é—®å™¨**: éªŒè¯ä¸“ç”¨æœåŠ¡åˆ›å»º

### 3. Bundle æµ‹è¯•

- **ä¾èµ–å…³ç³»**: éªŒè¯ Bundle ä¾èµ–æ­£ç¡®å£°æ˜Ž
- **å®žä¾‹åŒ–**: éªŒè¯ Bundle å¯æ­£å¸¸åˆ›å»º

### 4. EventSubscriber æµ‹è¯•

- **å•å…ƒæµ‹è¯•**: ç”¨æˆ·èŽ·å–é€»è¾‘ã€èº«ä»½æ˜ å°„éªŒè¯ã€å®‰å…¨ä¸Šä¸‹æ–‡å¤„ç†
- **é›†æˆæµ‹è¯•**: å®¹å™¨æœåŠ¡æ³¨å…¥ã€Doctrine äº‹ä»¶å±žæ€§ã€æŽ¥å£å®žçŽ°éªŒè¯

### 5. Traits æµ‹è¯•

- **BlameableAware**: å±žæ€§è®¾ç½®/èŽ·å–ã€é»˜è®¤å€¼ã€é“¾å¼è°ƒç”¨ã€åå°„éªŒè¯

### 6. Integration æµ‹è¯•

- **åŸºç¡€é›†æˆ**: Bundle å’Œæ ¸å¿ƒæœåŠ¡çš„åŸºæœ¬é›†æˆéªŒè¯

## æµ‹è¯•è¦†ç›–èŒƒå›´

### âœ… å·²è¦†ç›–çš„åŠŸèƒ½

- Attribute ç±»å®Œæ•´åŠŸèƒ½
- DependencyInjection é…ç½®åŠ è½½
- Bundle ä¾èµ–ç®¡ç†
- UserListener æ ¸å¿ƒé€»è¾‘
- BlameableAware Trait æ‰€æœ‰æ–¹æ³•
- æœåŠ¡å®¹å™¨é›†æˆ

### ðŸ” æµ‹è¯•é‡ç‚¹åœºæ™¯

- **ç”¨æˆ·æœªç™»å½•**: éªŒè¯ä¸æŠ›å¼‚å¸¸ï¼Œä¸è®¾ç½®ç”¨æˆ·ä¿¡æ¯
- **ç”¨æˆ·å·²ç™»å½•ä½†ä¸åœ¨èº«ä»½æ˜ å°„**: å®‰å…¨å›žé€€å¤„ç†
- **ç”¨æˆ·æ­£å¸¸ç™»å½•**: å±žæ€§æ­£ç¡®è®¾ç½®ï¼ˆéœ€è¦çœŸå®žçŽ¯å¢ƒæµ‹è¯•ï¼‰
- **å±žæ€§åå°„**: ç¡®ä¿å±žæ€§å¯è¢«æ­£ç¡®è¯†åˆ«å’Œå¤„ç†
- **æœåŠ¡æ³¨å…¥**: éªŒè¯å®¹å™¨é…ç½®æ­£ç¡®

### âš ï¸ é™åˆ¶è¯´æ˜Ž

ç”±äºŽæµ‹è¯•çŽ¯å¢ƒé™åˆ¶ï¼Œæ— æ³•å®Œæ•´æµ‹è¯•ä»¥ä¸‹åœºæ™¯ï¼š

- çœŸå®žç”¨æˆ·ç™»å½•çŠ¶æ€ä¸‹çš„å®žä½“æŒä¹…åŒ–
- å®Œæ•´çš„ Doctrine äº‹ä»¶æµç¨‹
- å®žé™…çš„å±žæ€§è‡ªåŠ¨è®¾ç½®åŠŸèƒ½

è¿™äº›åœºæ™¯éœ€è¦åœ¨çœŸå®žåº”ç”¨çŽ¯å¢ƒä¸­éªŒè¯ã€‚

## æµ‹è¯•æ‰§è¡Œ

### æ ‡å‡†æ‰§è¡Œå‘½ä»¤

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
./vendor/bin/phpunit packages/doctrine-user-bundle/tests
```

### å•ç‹¬æµ‹è¯•ç±»åž‹

```bash
# åªè¿è¡Œå•å…ƒæµ‹è¯•
./vendor/bin/phpunit packages/doctrine-user-bundle/tests --exclude-group integration

# åªè¿è¡Œé›†æˆæµ‹è¯•
./vendor/bin/phpunit packages/doctrine-user-bundle/tests --group integration
```

## æµ‹è¯•ç»“æžœ

âœ… **æµ‹è¯•çŠ¶æ€**: å…¨éƒ¨é€šè¿‡
ðŸ“Š **æµ‹è¯•ç»Ÿè®¡**: 33 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œ72 ä¸ªæ–­è¨€
â±ï¸ **æ‰§è¡Œæ—¶é—´**: 0.029 ç§’
ðŸ’¾ **å†…å­˜ä½¿ç”¨**: 16.00 MB

## æµ‹è¯•è´¨é‡åˆ†æž

- **æ–­è¨€å¯†åº¦**: å¹³å‡æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ 2.18 ä¸ªæ–­è¨€ï¼ˆ72Ã·33ï¼‰
- **æ‰§è¡Œæ•ˆçŽ‡**: æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹å¹³å‡æ‰§è¡Œæ—¶é—´ 0.88msï¼ˆ29msÃ·33ï¼‰
- **å†…å­˜æ•ˆçŽ‡**: æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹å¹³å‡å†…å­˜ä½¿ç”¨ 0.48MBï¼ˆ16MBÃ·33ï¼‰

æ ¹æ® @phpunit.mdc è§„èŒƒçš„è´¨é‡æ ‡å‡†ï¼š

- âœ… **æ–­è¨€å¯†åº¦**: 2.18 > 1.5ï¼ˆè‰¯å¥½æ ‡å‡†ï¼‰
- âœ… **æ‰§è¡Œæ•ˆçŽ‡**: 0.88ms < 5msï¼ˆä¼˜ç§€æ ‡å‡†ï¼‰
- âœ… **å†…å­˜æ•ˆçŽ‡**: 0.48MB < 0.5MBï¼ˆä¼˜ç§€æ ‡å‡†ï¼‰

## è´¨é‡æ£€æŸ¥æ¸…å•

- [x] æ‰€æœ‰ä¾èµ–æ­£ç¡®å®‰è£…
- [x] æµ‹è¯•å‘½åç¬¦åˆè§„èŒƒ
- [x] æ¯ä¸ªæµ‹è¯•æ–¹æ³•å•ä¸€èŒè´£
- [x] æ–­è¨€è¦†ç›–å®Œæ•´
- [x] æ—  PHP Deprecated è­¦å‘Š
- [x] æµ‹è¯•ç±»åž‹é€‰æ‹©æ­£ç¡®
- [x] å‘½åç©ºé—´æ­£ç¡®
- [x] ä»£ç ç¬¦åˆ PSR è§„èŒƒ
